{% extends "base.html" %}
{% block content %}
<h1 class="mb-4">Overview</h1>
<div class="row g-3 mb-4">
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card">
      <div class="card-body d-flex align-items-center">
        <i class="bi bi-diagram-3 fs-1 text-primary me-3"></i>
        <div>
          <small class="text-muted">Alliances</small>
          <div class="fs-4 fw-bold">{{ stats.alliances }}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card">
      <div class="card-body d-flex align-items-center">
        <i class="bi bi-people fs-1 text-primary me-3"></i>
        <div>
          <small class="text-muted">Members</small>
          <div class="fs-4 fw-bold">{{ stats.members }}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card">
      <div class="card-body d-flex align-items-center">
        <i class="bi bi-graph-up fs-1 text-primary me-3"></i>
        <div>
          <small class="text-muted">Gift Success %</small>
          <div class="fs-4 fw-bold">{{ stats.success_rate }}%</div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12 col-sm-6 col-xl-3">
    <div class="card">
      <div class="card-body d-flex align-items-center">
        <i class="bi bi-clock fs-1 text-primary me-3"></i>
        <div>
          <small class="text-muted">Next Run</small>
          <div class="fs-4 fw-bold">{{ stats.next_run }}</div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="card">
  <div class="card-body">
    <h5 class="card-title">Redemptions / Day</h5>
    <canvas id="lineChart" height="100"></canvas>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const ctx = document.getElementById('lineChart');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: {{ charts.labels|tojson }},
      datasets: [{
        data: {{ charts.values|tojson }},
        fill: true,
        borderColor: '#0d6efd',
        backgroundColor: 'rgba(13,110,253,.2)',
        tension: 0.3
      }]
    },
    options: {
      plugins: { legend: { display: false } },
      scales: { x: { grid: { display: false } }, y: { beginAtZero: true } }
    }
  });
</script>
{% endblock %}
